<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>REGAPP</title>
	
</h:head>

<h:body style="background-image:url('image/bg.jpeg');background-size:cover;background-position: center;">

	<h:outputStylesheet library="webjars" name="font-awesome/5.12.0/css/all.min-jsf.css" />
	<h:outputStylesheet library="webjars" name="font-awesome/5.12.0/css/v4-shims.min-jsf.css" />
	<link rel = "stylesheet" type = "text/css" href = "./css/base.css"/>
	
	<h:form id="mainForm">
		<br style="visibility:hidden;"/>
		<p:tabView style="height:500px;" id="cmds">
    	    
    	    <p:tab title="Ricerca">
				<h:form id="searchForm">
					<p:growl id="growl" showDetail="true" sticky="false" severity="info" />
					
					<p:panelGrid columns="4" layout="grid" styleClass="ui-panelgrid-blank" columnClasses="ui-grid-col-2, ui-grid-col-4 ui-fluid,ui-grid-col-2, ui-grid-col-4 ui-fluid">
						<p:outputLabel value="Nome" />
						<p:inputText value="#{contactBean.searchedUser.firstName}" />
						<p:outputLabel value="Cognome" />
						<p:inputText value="#{contactBean.searchedUser.lastName}" />
					</p:panelGrid>
				
					<p:panelGrid columns="4" layout="grid" styleClass="ui-panelgrid-blank" columnClasses="ui-grid-col-2, ui-grid-col-4 ui-fluid,ui-grid-col-2, ui-grid-col-4 ui-fluid">
						<p:outputLabel value="Codice fiscale" />
						<p:inputText  value="#{contactBean.searchedUser.contactId}"/>
						<p:outputLabel value="Tipo contatto"/>
						<p:selectOneMenu value="#{contactBean.contactTypeString}" >
							<f:selectItems value="#{contactBean.types}" var="type" itemValue="#{type.label}" itemLabel="#{type.label}" />
						</p:selectOneMenu>
					</p:panelGrid>
					<br style="visibility:hidden;"/>
					<center>
						<p:commandButton id="searchButton" actionListener="#{contactBean.loadSearchedUsers}" process="@this" value="Cerca" icon="fa fa-search" update="mainForm:cmds:searchForm"/>				
					</center>
				</h:form>
				<p:separator/>
				<p:outputPanel>
					<p:dataTable headerText="Risultati ricerca" rendered="#{not empty contactBean.searchedUsers}" id="dtUsers" value="#{contactBean.searchedUsers}" var="user" paginator="true" rows="5" paginatorPosition="bottom" >
        				<p:column style="text-align:center;" headerText="Nome">
        					<h:outputText value="#{user.firstName}" />
        				</p:column>
        				<p:column style="text-align:center;" headerText="Cognome">
        					<h:outputText value="#{user.lastName}"/>
        				</p:column>
        				<p:column style="text-align:center;" headerText="Codice fiscale">
        					<h:outputText value="#{user.contactId}" />
        				</p:column>
        				<p:column style="text-align:center;" headerText="Tipo contatto">
        					<h:outputText value="#{user.contactType}" />
        				</p:column>
   					</p:dataTable>
				</p:outputPanel>
        	</p:tab>
        	<p:tab title="Creazione">
				<h:form id="saveContactForm">
					<p:growl id="growl" showDetail="true" sticky="false" severity="info" />
				
					<p:panelGrid columns="4" layout="grid" styleClass="ui-panelgrid-blank" columnClasses="ui-grid-col-2, ui-grid-col-5 ui-fluid,ui-grid-col-2, ui-grid-col-5 ui-fluid">
						<p:outputLabel value="Nome" />
						<p:inputText id="firstNameInput" value="#{contactBean.contact.firstName}" />
						<p:outputLabel value = "Cognome"/>
						<p:inputText value="#{contactBean.contact.lastName}" />
					</p:panelGrid>
					
					<p:panelGrid columns="4" layout="grid" styleClass="ui-panelgrid-blank" columnClasses="ui-grid-col-2, ui-grid-col-5 ui-fluid,ui-grid-col-2, ui-grid-col-5 ui-fluid">
						<p:outputLabel value="Codice fiscale" />
						<p:inputText value="#{contactBean.contact.contactId}" />
						<p:outputLabel value="Tipo del contatto" />
						<p:selectOneMenu value="#{contactBean.contactTypeString}" >
							<f:selectItems value="#{contactBean.types}" var="type" itemValue="#{type.label}" itemLabel="#{type.label}" />
						</p:selectOneMenu>
					</p:panelGrid>
					
					<p:separator/>
					<center>
						<p:commandButton id="saveButton" actionListener="#{contactBean.saveContact}" process="@this:saveContactForm" value="Salva" icon="fa fa-save" update="mainForm:cmds:saveContactForm, mainForm:cmds:dtContacts"/>				
					</center>
				</h:form>
        	</p:tab>
        	
        	<p:tab title="Modifica">
				<p:panelGrid columns="2" layout="grid" styleClass="ui-panelgrid-blank" columnClasses="ui-grid-col-6 ui-fluid, ui-grid-col-12 ui-fluid">

					<p:outputPanel> 
						<p:dataTable id="dtContacts" value="#{contactBean.users}" var="user" paginator="true" selection="#{contactBean.selectedUser}" selectionMode="single" rowKey="#{user.contactId}" rows="8" paginatorPosition="bottom" >
        					<p:ajax event="rowSelect" listener="#{contactBean.onRowSelect}" update="mainForm:cmds:editContactForm"/>
        					<p:column headerText="Utenti esistenti">
        						<h:outputText value="#{user.firstName}, #{user.lastName}, #{user.contactId}" />
        					</p:column>
   				 		</p:dataTable>
					</p:outputPanel>
					<h:form id="editContactForm">
						<p:growl id="growl" showDetail="true" sticky="false" severity="info" />
				
						<p:panelGrid columns="4" layout="grid" styleClass="ui-panelgrid-blank" columnClasses="ui-grid-col-2, ui-grid-col-5 ui-fluid,ui-grid-col-2, ui-grid-col-5 ui-fluid">
							<p:outputLabel value="Nome" />
							<p:inputText placeholder="#{contactBean.selectedUser.firstName}" id="firstNameInput" value="#{contactBean.contact.firstName}" />
							<p:outputLabel value = "Cognome"/>
							<p:inputText placeholder="#{contactBean.selectedUser.lastName}" value="#{contactBean.contact.lastName}" />
						</p:panelGrid>
						<p:panelGrid columns="4" layout="grid" styleClass="ui-panelgrid-blank" columnClasses="ui-grid-col-2, ui-grid-col-5 ui-fluid,ui-grid-col-2, ui-grid-col-5 ui-fluid">
							<p:outputLabel value="Codice fiscale" />
							<p:inputText placeholder="#{contactBean.selectedUser.contactId}" value="#{contactBean.contact.contactId}" />
							<p:outputLabel value="Tipo del contatto" />
							<p:selectOneMenu value="#{contactBean.contactTypeString}" >
								<f:selectItems value="#{contactBean.types}" var="type" itemValue="#{type.label}" itemLabel="#{type.label}" />
							</p:selectOneMenu>
					
						</p:panelGrid>
						<p:separator style="visibility:hidden;"/>
						<p:separator/>
						<center>
							<p:commandButton style="width:350px;" actionListener="#{contactBean.editContact}" process="@this:editContactForm" update="@form" value="Modifica" icon="fa fa-save" />				
						</center>
					</h:form>
				</p:panelGrid>
        	</p:tab>
   		</p:tabView>
	</h:form>
</h:body>

</html>
